*&---------------------------------------------------------------------*
*& 包含               ZPPD201_TOP
*&---------------------------------------------------------------------*
TYPE-POOLS: SSCR,SLIS.
DATA: FLDCT TYPE SLIS_T_FIELDCAT_ALV,
      SLAYT TYPE SLIS_LAYOUT_ALV,
      VARNT LIKE DISVARIANT,
      REPID LIKE SY-REPID,
      TABIX LIKE SY-TABIX.
DATA:IT_FIELDCAT_JSXD   TYPE LVC_T_FCAT,
     IT_FIELDCATEX_JSXD TYPE LVC_T_FCAT,
     WA_FIELDCAT_JSXD   TYPE LVC_S_FCAT,
     IT_F4_JSXD         TYPE  LVC_T_F4,
     WA_F4_JSXD         TYPE  LVC_S_F4,
     IS_STABLE_JSXD     TYPE LVC_S_STBL,
     WA_LAYOUT_JSXD     TYPE LVC_S_LAYO.
DATA:IT_FIELDCAT_JGMX   TYPE LVC_T_FCAT,
     IT_FIELDCATEX_JGMX TYPE LVC_T_FCAT,
     WA_FIELDCAT_JGMX   TYPE LVC_S_FCAT,
     IT_F4_JGMX         TYPE  LVC_T_F4,
     WA_F4_JGMX         TYPE  LVC_S_F4,
     IS_STABLE_JGMX     TYPE LVC_S_STBL,
     WA_LAYOUT_JGMX     TYPE LVC_S_LAYO.
DATA:IT_FIELDCAT_PCD   TYPE LVC_T_FCAT,
     IT_FIELDCATEX_PCD TYPE LVC_T_FCAT,
     WA_FIELDCAT_PCD   TYPE LVC_S_FCAT,
     WA_FIELDCAT       TYPE LVC_S_FCAT,
     IT_F4_PCD         TYPE  LVC_T_F4,
     WA_F4_PCD         TYPE  LVC_S_F4,
     IS_STABLE_PCD     TYPE LVC_S_STBL,
     WA_LAYOUT_PCD     TYPE LVC_S_LAYO.
DATA:BEGIN OF IT_BOM OCCURS 0,
       MATNR TYPE MATNR,
       STLKN TYPE STPO-STLKN,
       MAKTX TYPE MAKTX,
       LGORT TYPE LGORT_D,
       LABST TYPE MARD-LABST,
       SEL,
     END OF IT_BOM,
     BEGIN OF IT_BANFN OCCURS 0,
       BANFN TYPE BANFN,
     END OF IT_BANFN.
DATA:BEGIN OF IT_VBELN OCCURS 0."首屏alv
       INCLUDE TYPE ZSPUBS_0001.
DATA:
       VBELN    TYPE VBAK-VBELN,
       POSNR    TYPE VBAP-POSNR,
       BEZEI    TYPE TVAKT-BEZEI,
       JSXD     TYPE CHAR1,
       JGMX     TYPE CHAR1,
       PCD      TYPE CHAR1,
       KUNNR    TYPE VBAK-KUNNR,
       NAME1    TYPE KNA1-NAME1,
       BSTKD    TYPE VBKD-BSTKD,
       AUART    TYPE VBAK-AUART,
       KWMENG   TYPE VBAP-KWMENG,
       MATNR    TYPE VBAP-MATNR,
       MAKTX    TYPE MAKTX,
       WERKS    TYPE VBAP-WERKS,
       ZPCSL    TYPE VBAP-KWMENG, "排产数量
       ZYPCSL   TYPE VBAP-KWMENG, "已排产数量
       ZWPCSL   TYPE VBAP-KWMENG, "未排产数量

       YXMNG_JH TYPE VBAP-KWMENG, "已下-计划
       WQMNG_JH TYPE VBAP-KWMENG, "未清-计划
       DLMNG    TYPE VBAP-KWMENG, "已交货量
       WJHMNG   TYPE VBAP-KWMENG, "未交货量
       ITM_TXT  TYPE CHAR100, "文本
       ZJHWQXD  TYPE CHAR1,       "计划完全下达
       EDATU    TYPE VBEP-EDATU,  "交货日期

       MEINS    TYPE MARA-MEINS,
       MATKL    TYPE MARA-MATKL,
       ERDAT    TYPE VBAP-ERDAT,
       ERNAM    TYPE VBAP-ERNAM,

       CLABS    TYPE MCHB-CLABS, "库存量
       THKC     TYPE MCHB-CLABS, "退货库存

       PROJN    TYPE VBAP-PS_PSP_PNR,
       POSID    TYPE PRPS-POSID,
       POST1    TYPE PRPS-POST1,
       SEL,

       MATNR211 TYPE MATNR,
       MATNR207 TYPE MATNR,
       MATNR205 TYPE MATNR,
       PROJN211 TYPE PRPS-POSID,
       PROJN207 TYPE PRPS-POSID,
       SELECT,
       ZZL1     TYPE MARA-ZZL1,
       WLCMS    TYPE CHAR220,
       MVGR2    TYPE VBAP-MVGR2,
       TVM2T    TYPE TVM2T-BEZEI,
       ICON     TYPE ICON-ID,
       ZHTLY TYPE VBAK-ZHTLY,
       VTWEG TYPE VBAK-VTWEG,
     END OF IT_VBELN.
DATA:WA_205 TYPE ZTPP_205.
DATA:BEGIN OF IT_JSXD OCCURS 0."技术详单ooalv
       INCLUDE TYPE ZTPP_211.
DATA:  ZKS_BCPC TYPE ZTPP_205A-ZKS, "本次排产块数
       ZKS_YPC  TYPE ZTPP_205A-ZKS, "该长度已排产块数
       ZKS_WPC  TYPE ZTPP_205A-ZKS, "该长度未排产块数
       ZPCSL    TYPE VBAP-KWMENG, "排产数量
       ZYPCSL   TYPE VBAP-KWMENG, "已排产数量
       CHBOX,
       MAKTX    TYPE MAKTX,
       ZPCDH    TYPE ZTPP_205A-ZPCDH,
       ZPCDHH   TYPE ZTPP_205A-ZPCDHH,
       ZWLCMS   TYPE STRING,
       DEL_OO   TYPE CHAR1, "用于往排产单屏幕追加技术详单行
       ZYSKS    TYPE ZTPP316-ZZK,
     END OF IT_JSXD.
DATA:IT_JSXD1 LIKE TABLE OF IT_JSXD WITH HEADER LINE."技术详单行取数
DATA:BEGIN OF IT_JGMX OCCURS 0."加工明细
       INCLUDE TYPE ZTSD207.
DATA:  ZSL_BCPC TYPE ZTPP_205A-ZAMOUNT, "本次排产数量
       ZSL_YPC  TYPE ZTPP_205A-ZAMOUNT, "该长度已排产数量
       ZSL_WPC  TYPE ZTPP_205A-ZAMOUNT, "该长度未排产数量
       CHBOX,
       MAKTX    TYPE MAKTX,
       ZPCDH    TYPE ZTPP_205A-ZPCDH,
       ZPCDHH   TYPE ZTPP_205A-ZPCDHH,
       DEL_OO   TYPE CHAR1, "用于往排产单屏幕追加加工明细行
       ZWLCMS   TYPE STRING,
     END OF IT_JGMX.
DATA:BEGIN OF WA_GGZD."公共字段
       INCLUDE TYPE ZTPP_205B.
DATA:  POST1   TYPE PRPS-POST1,
       NAME1   TYPE NAME1,
       EDATU   TYPE VBEP-EDATU,
       WLCMS   TYPE STRING,
       ZKS_SUM TYPE ZTPP_205A-ZKS,
       ZCD_SUM TYPE ZTPP_205A-ZCD,
       ZPCSL   TYPE ZTPP_205-ZPCSL,
       TDID    TYPE TDID,
       BSTKD   TYPE VBKD-BSTKD,
       VBELN   TYPE VBELN,
       MATNR   TYPE MATNR,
       POSID   TYPE PRPS-POSID,
       ZZSL    TYPE ZTPP_205A-ZKS,
       QGDH    TYPE CHAR10,
       ZKDJE   TYPE KBETR,
       ZJJJE   TYPE KBETR,
       ZXGJE   TYPE KBETR,
       ZMJJE   TYPE KBETR,
       ZHTLYT  TYPE CHAR30,
       ZYWYT   TYPE CHAR30,
       VKGRPT  TYPE CHAR30,
       VTWEGT  TYPE CHAR30,
       KLABC   TYPE KNVV-KLABC,
       MEINS   TYPE MEINS,
       ZZL1    TYPE MARA-ZZL1,
       GROES   TYPE MARA-GROES,
       ZDJSCDZ TYPE VBAK-ZDJSCDZ,
     END OF WA_GGZD.

DATA:BEGIN OF IT_PCD OCCURS 0."排产单
       INCLUDE TYPE ZTPP_205A.
DATA:  ZKS_BCPC  TYPE ZTPP_205A-ZKS, "本次排产块数
       ZKS_YPC   TYPE ZTPP_205A-ZKS, "该长度已排产块数
       ZKS_WPC   TYPE ZTPP_205A-ZKS, "该长度未排产块数
       ZYPCSL    TYPE VBAP-KWMENG, "已排产数量
       SEL,
       FQR       TYPE ZTPP_210-FQR,
       FLAG      TYPE ZTPP_210-FLAG,
       MAKTX     TYPE MAKTX,
       CHBOX,
       ZYSKS     TYPE ZTPP316-ZZK,
       ZZL1      TYPE MARA-ZZL1,
       ZJSSL1    TYPE MENGE_D,
       ZSCGD     TYPE ATWRT30,
       ZDKGD     TYPE ATWRT30,
       ZSCKD     TYPE ATWRT30,
       ZDKKD     TYPE ATWRT30,
       DELFLG    TYPE CHAR1,
       CELLCOLOR TYPE LVC_T_SCOL, "定义单元格数据数据类型
     END OF IT_PCD.

DATA:BEGIN OF F4_BSTKD OCCURS 0,
       BSTKD TYPE VBKD-BSTKD,
     END OF F4_BSTKD.
DATA: RETURN_TAB TYPE DDSHRETVAL OCCURS 0,
      WA_MODI    TYPE LVC_S_MODI.

DATA:NUM  TYPE I,
     FLAG TYPE CHAR1.

DATA:BEGIN OF WA_TZ,"弹窗
       ZZL1    TYPE MARA-ZZL1,
       WLCMS   TYPE STRING,
       VRKME   TYPE VBAP-VRKME,
       WERKS   TYPE WERKS_D,
       ZXISHU  TYPE ZTPP_205A-ZXISHU,
       ZSCDW   TYPE ZTPP_205B-ZSCDW,
       ZJGLX   TYPE ZTPP_205B-ZJGLX,
       ZBZFS   TYPE ZTPP_205B-ZBZFS,
       ZJHRQ   TYPE ZTPP_205-ZJHRQ,
       ZZLJSFS TYPE ZTPP_205B-ZZLJSFS,
     END OF WA_TZ.

DATA:GV_SUBSCREEN_800 TYPE SY-DYNNR.
DATA:GV_SUBSCREEN_HEAD TYPE SY-DYNNR.
DATA:OK_CODE LIKE SY-UCOMM,
     SAVE_OK LIKE SY-UCOMM,
     RETCODE,
     GV_MSG  TYPE BAPI_MSG.
DATA: CONTAINER_GG    TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      EDITOR_GG       TYPE REF TO CL_GUI_TEXTEDIT,
      CONTAINER_WLCMS TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      EDITOR_WLCMS    TYPE REF TO CL_GUI_TEXTEDIT,
      CONTAINER_QGDH  TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      EDITOR_QGDH     TYPE REF TO CL_GUI_TEXTEDIT,
      CONTAINER_WHTPC TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      EDITOR_WHTPC    TYPE REF TO CL_GUI_TEXTEDIT,
      CONTAINER_BZ    TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      EDITOR_BZ       TYPE REF TO CL_GUI_TEXTEDIT,
      CONTAINER_JGMX  TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      EDITOR_JGMX     TYPE REF TO CL_GUI_TEXTEDIT.

DATA:BEGIN OF IT_TEXT OCCURS 0,
       TDID TYPE STXL-TDID.
       INCLUDE STRUCTURE ZSMM202.
DATA:END OF IT_TEXT.
DATA:T_TEXT TYPE TABLE OF ZSMM202 WITH HEADER LINE.

DATA: TEXTTABLE     TYPE TABLE OF ZSMM202 WITH HEADER LINE,
      LINES_WLCMS   TYPE STANDARD TABLE OF TLINE,
      IT_LINE_WLCMS TYPE STANDARD TABLE OF LINE,
      LINES_WHTPC   TYPE STANDARD TABLE OF TLINE,
      IT_LINE_WHTPC TYPE STANDARD TABLE OF LINE,
      LINES_QGDH    TYPE STANDARD TABLE OF IT_TEXT,
      IT_LINE_QGDH  TYPE STANDARD TABLE OF ZSMM202 WITH HEADER LINE,
      LINES_GG      TYPE STANDARD TABLE OF TLINE,
      IT_LINE_GG    TYPE STANDARD TABLE OF LINE.


TYPES:BEGIN OF TY_LIST,
        ID    TYPE CHAR10,
        VALUE TYPE CHAR50,
      END OF TY_LIST.
DATA:IT_LIST TYPE TABLE OF TY_LIST WITH HEADER LINE.
DATA:TDID TYPE TDID.
*备注下拉框
REFRESH IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P001'.
IT_LIST-VALUE = '装运要求'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P002'.
IT_LIST-VALUE = '包装要求'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P003'.
IT_LIST-VALUE = '请购信息'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P004'.
IT_LIST-VALUE = '芯材要求'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P005'.
IT_LIST-VALUE = '内板覆膜要求'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P006'.
IT_LIST-VALUE = '外板覆膜要求'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P007'.
IT_LIST-VALUE = '钢卷使用要求'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P008'.
IT_LIST-VALUE = '辅料要求'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P009'.
IT_LIST-VALUE = '板上标注信息'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P010'.
IT_LIST-VALUE = '特殊覆膜要求'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P011'.
IT_LIST-VALUE = '两侧封边要求'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P012'.
IT_LIST-VALUE = '备注'.
APPEND IT_LIST.
CLEAR:IT_LIST.
IT_LIST-ID = 'P013'.
IT_LIST-VALUE = '加工明细表备注'.
APPEND IT_LIST.

DATA:BCBS TYPE CHAR1 VALUE '0'."保存标识,800屏幕返回时用
DATA:PCLX TYPE ZE_ZPCLX."jsxd,jgmx,wht,whtv,zwj,jhb,lcd.
DATA: ATNAMSTR TYPE STRING,
      INTAB    TYPE TABLE OF MCHA WITH HEADER LINE,
      OUTTAB   TYPE TABLE OF ZSFMS_GETPCTX WITH HEADER LINE.
TYPES:BEGIN OF TY_PCTX,
        ZZL1     TYPE MARA-ZZL1,
        ZBX      TYPE ATWRT,
        ZBK      TYPE ATWRT,
        ZWBXZ    TYPE ATWRT,
        ZXCZL    TYPE ATWRT,
        ZNBHD    TYPE ATWRT,
        ZWBHD    TYPE ATWRT,
        ZJQJYQ   TYPE ATWRT,
        ZSGBPP   TYPE ATWRT,
        ZWBCD    TYPE ATWRT,
        ZWBFM    TYPE ATWRT,
        ZXCRZ    TYPE ATWRT,
        ZNBYS    TYPE ATWRT,
        ZWBYS    TYPE ATWRT,
        ZFBYQ    TYPE ATWRT,
        ZSGBFSYQ TYPE ATWRT,
        ZNBQD    TYPE ATWRT,
        ZNBXZ    TYPE ATWRT,
        ZRSDJ    TYPE ATWRT,
        ZNBDC    TYPE ATWRT,
        ZWBQD    TYPE ATWRT,
        ZLGLX    TYPE ATWRT,
        ZHF      TYPE ATWRT,
        ZNBFM    TYPE ATWRT,
        ZBH      TYPE ATWRT,
        ZNBTC    TYPE ATWRT,
        ZWBDC    TYPE ATWRT,
        ZSCHD    TYPE ATWRT,
        ZGNXP    TYPE ATWRT,
        ZXCCD    TYPE ATWRT,
        ZNBCZ    TYPE ATWRT,
        ZWBCZ    TYPE ATWRT,
        ZWBTC    TYPE ATWRT,
        ZLFWGG   TYPE ATWRT,
        ZNBCD    TYPE ATWRT,
      END OF TY_PCTX.

DATA:BEGIN OF WA_WHTPC.
       INCLUDE TYPE TY_PCTX.
DATA:  WERKS TYPE WERKS_D,
       MATNR TYPE MATNR,
     END OF WA_WHTPC.
DATA:IT_COMP          TYPE ABAP_COMPDESCR_TAB WITH HEADER LINE,
     LR_REF_TABLE_DES TYPE  REF  TO CL_ABAP_STRUCTDESCR.
DATA:BEGIN OF WA_WHTPC_TC,
       ZPCDH  TYPE ZTPP_205A-ZPCDH,
       ZPCDHH TYPE ZTPP_205A-ZPCDHH,
       MATNR  TYPE ZTPP_205A-MATNR,
       WERKS  TYPE ZTPP_205A-WERKS,
       ZCD    TYPE ZTPP_205A-ZCD,
       ZBCKD  TYPE ZTPP_205A-ZBCKD,
       ZKS    TYPE ZTPP_205A-ZKS,
       ZXISHU TYPE ZTPP_205A-ZXISHU,
       ZPCSL  TYPE ZTPP_205A-ZPCSL,
       WLCMS  TYPE CHAR220,
     END OF WA_WHTPC_TC.
**********************************************************************
" 排产单打印开始 by kkw 19.12.2022 19:32:50
**********************************************************************
DATA:TMPLID   TYPE STRING,
     ZHANGID  TYPE STRING,
     DATAJSON TYPE STRING,
     OSSKEY   TYPE STRING.
TYPES: T_ZWZONGMISHU12 TYPE STRING.
TYPES: T_ZWLENGTH11 TYPE STRING.
TYPES: T_ZWKUAISHU10 TYPE STRING.
TYPES: T_CHICUN9 TYPE STRING.
TYPES: TT_ZWZONGMISHU12 TYPE STANDARD TABLE OF T_ZWZONGMISHU12 WITH DEFAULT KEY.
TYPES: TT_ZWLENGTH11 TYPE STANDARD TABLE OF T_ZWLENGTH11 WITH DEFAULT KEY.
TYPES: TT_ZWKUAISHU10 TYPE STANDARD TABLE OF T_ZWKUAISHU10 WITH DEFAULT KEY.
TYPES: TT_CHICUN9 TYPE STANDARD TABLE OF T_CHICUN9 WITH DEFAULT KEY.
TYPES: BEGIN OF T_DAKONG2,
         BEIZHU     TYPE STRING,
         DKFANGSHI  TYPE STRING,
         ID         TYPE I,
         JIAGONGFEI TYPE STRING,
         MM         TYPE STRING,
         MONEY      TYPE STRING,
       END OF T_DAKONG2.
TYPES: BEGIN OF T_JINGHUAMEN4,
         CANSHU               TYPE STRING,
         ISPRICE              TYPE ABAP_BOOL,
         MENBOLILEIXING       TYPE STRING,
         MENGAO               TYPE STRING,
         MENKUAN              TYPE STRING,
         MENKUANGHOUDU        TYPE STRING,
         MENLEIXING           TYPE STRING,
         MENSHANGCHUANGCHICUN TYPE STRING,
         MENSHICHUANGYINBIAN  TYPE STRING,
         MENSUOJU             TYPE STRING,
         MENXINCAI            TYPE STRING,
         MENYANSE             TYPE STRING,
         PINGFANGSHU          TYPE STRING,
       END OF T_JINGHUAMEN4.
TYPES: BEGIN OF T_LIST5,
         ID              TYPE I,
         BIANHAO         TYPE STRING,
         KUAISHU         TYPE STRING,
         LEIXING         TYPE STRING,
         LENGTH          TYPE STRING,
         MISHU           TYPE STRING,
         MKFANGXIANGNAME TYPE STRING,
         MM              TYPE STRING,
         MONEY           TYPE STRING,
         PRICE           TYPE STRING,
         WIDTH           TYPE STRING,
         XISHU           TYPE STRING,
       END OF T_LIST5.
TYPES: BEGIN OF T_ORDER6,
         BANKUAN              TYPE STRING,
         BCOLOR               TYPE STRING,
         BEIZHU               TYPE STRING,
         CAIZHI               TYPE STRING,
         CDATE                TYPE STRING,
         COLOR                TYPE STRING,
         CUSERNAME            TYPE STRING,
         CUSTOMERNAME         TYPE STRING,
         DDATE                TYPE STRING,
         DUCENG               TYPE STRING,
         FENGBIANYAOQIU       TYPE STRING,
         FUMO2                TYPE STRING,
         GOODSTYPENAME        TYPE STRING,
         GUIGE                TYPE STRING,
         HASWISKINDLOGO       TYPE STRING,
         HOUDU                TYPE STRING,
         INNERPLATESLITTING   TYPE STRING,
         ISPRICE              TYPE ABAP_BOOL,
         JGBEIZHU             TYPE STRING,
         KEFUNAME             TYPE STRING,
         KUAISHU              TYPE STRING,
         LENGTH               TYPE STRING,
         MISHU                TYPE STRING,
         MODEL                TYPE STRING,
         NAME                 TYPE STRING,
         NO                   TYPE STRING,
         OUTERPLATESLITTING   TYPE STRING,
         PCNO                 TYPE STRING,
         PRESSURE             TYPE STRING,
         PRICE                TYPE STRING,
         PRODUCEDEPNAME       TYPE STRING,
         PROJECTNAME          TYPE STRING,
         RANSHAOLEVELNAME     TYPE STRING,
         SCLEIXINGNAME        TYPE STRING,
         SECOND_CATEGORY_NAME TYPE STRING,
         SELLBEIZHU           TYPE STRING,
         TIHUO                TYPE STRING,
         TUCENG               TYPE STRING,
         UNITNAME             TYPE STRING,
         VDATE                TYPE STRING,
         WEIZHI               TYPE STRING,
         WIDTH                TYPE STRING,
         XINCAI               TYPE STRING,
         XINGZHUANG2          TYPE STRING,
         YEWUYUANNAME         TYPE STRING,
         YSZKUAISHU           TYPE STRING,
         ZONGJINE             TYPE STRING,
         ZONGLIANG            TYPE STRING,
         ZONGPINGFANG         TYPE STRING,
       END OF T_ORDER6.
TYPES: BEGIN OF T_TOTAL7,
         CHINESE TYPE STRING,
         TMONEY  TYPE STRING,
       END OF T_TOTAL7.
TYPES: BEGIN OF T_ZHEWAN8,
         BUILDINGNAME TYPE STRING,
         CHANDI       TYPE STRING,
         CHICUN       TYPE TT_CHICUN9,
         COLOR        TYPE STRING,
         GCID         TYPE STRING,
         MIANNAME     TYPE STRING,
         ZWBEIZHU     TYPE STRING,
         ZWBIANHAO    TYPE STRING,
         ZWDAKONG     TYPE STRING,
         ZWDETAILNAME TYPE STRING,
         ZWID         TYPE STRING,
         ZWIMGS       TYPE STRING,
         ZWKUAISHU    TYPE TT_ZWKUAISHU10,
         ZWLENGTH     TYPE TT_ZWLENGTH11,
         ZWMINBIAN    TYPE STRING,
         ZWMM         TYPE F,
         ZWMONEY      TYPE F,
         ZWPRICE      TYPE STRING,
         ZWZHANKUAN   TYPE STRING,
         ZWZHESHU     TYPE STRING,
         ZWZHEWANHD   TYPE STRING,
         ZWZONGMISHU  TYPE TT_ZWZONGMISHU12,
       END OF T_ZHEWAN8.
TYPES: BEGIN OF T_JINGHUACHUANG3,
         BOLICANSHU       TYPE STRING,
         CHUANGNEICHEN    TYPE STRING,
         GUIGECANSHU      TYPE STRING,
         ISPRICE          TYPE ABAP_BOOL,
         PINGFANGSHU      TYPE STRING,
         SHICHUANGCHANGDU TYPE STRING,
         SHICHUANGHOUDU   TYPE STRING,
         SHICHUANGKUANDU  TYPE STRING,
         SHICHUANGNEISHI  TYPE STRING,
         SHICHUANGXCHOUDU TYPE STRING,
         SHICHUANGYINBIAN TYPE STRING,
       END OF T_JINGHUACHUANG3.
TYPES: TT_LIST5 TYPE STANDARD TABLE OF T_LIST5 WITH DEFAULT KEY.
TYPES: TT_ZHEWAN8 TYPE STANDARD TABLE OF T_ZHEWAN8 WITH DEFAULT KEY.
TYPES: TT_DAKONG2 TYPE STANDARD TABLE OF T_DAKONG2 WITH DEFAULT KEY.
TYPES: BEGIN OF T_JSON1,
         DAKONG        TYPE TT_DAKONG2,
         ISPAICHAN     TYPE ABAP_BOOL,
         ISSCJH        TYPE ABAP_BOOL,
         JINGHUACHUANG TYPE T_JINGHUACHUANG3,
         JINGHUAMEN    TYPE T_JINGHUAMEN4,
         LIST          TYPE TT_LIST5,
         ORDER         TYPE T_ORDER6,
         PDFNAME       TYPE STRING,
         TOTAL         TYPE T_TOTAL7,
         ZHEWAN        TYPE TT_ZHEWAN8,
       END OF T_JSON1.
**********************************************************************
" 排产单打印结束 by kkw 19.12.2022 19:33:10
**********************************************************************
DATA:P_FILE TYPE RLGRAP-FILENAME.
DATA:BEGIN OF IT_ZWJ OCCURS 0,"折弯件
       ZBIANHAO    TYPE ZTPP_205A-ZBIANHAO, "编号
       ZZHANKUAN   TYPE ZTPP_205A-ZZHANKUAN, "展宽
       ZZWHD1      TYPE ZTPP_205A-ZZWHD1, "折弯厚度(厚度)
       ZZS         TYPE ZTPP_205A-ZZS, "折数
       ZCD         TYPE ZTPP_205A-ZCD, "长度(米)
       ZKS         TYPE ZTPP_205A-ZKS, "块数
       ZZWDJ       TYPE ZTPP_205A-ZZWDJ, "单价
       ZDETAILNAME TYPE ZTPP_205A-ZDETAILNAME, "详细名称
       ZXXF        TYPE ZTPP_205A-ZXXF, "信息费
       ZCDTX       TYPE ZTPP_205B-ZCDTX, "成兑贴息
       ZYF         TYPE ZTPP_205B-ZYF, "运费
       ZDTMC       TYPE ZTPP_205A-ZDTMC, "单体名称
       ZLMZX       TYPE ZTPP_205A-ZLMZX, "立面/轴线
     END OF IT_ZWJ.
DATA:BEGIN OF IT_JHB OCCURS 0,"手工板
       ZBIANHAO TYPE ZTPP_205A-ZBIANHAO, "编号
       ZJJLX    TYPE ZTPP_205A-ZJJLX, "类型
       ZBCKD    TYPE ZTPP_205A-ZBCKD, "宽度(毫米)
       ZCD      TYPE ZTPP_205A-ZCD, "长度(毫米)
       ZKS      TYPE ZTPP_205A-ZKS, "块数
       ZXISHU   TYPE ZTPP_205A-ZXISHU, "系数
       ZMXBZ    TYPE ZTPP_205A-ZMXBZ, "备注
       ZYF      TYPE ZTPP_205B-ZYF, "运费
     END OF IT_JHB.
DATA:BEGIN OF IT_LCD OCCURS 0,"丽彩鼎
       ZBIANHAO    TYPE ZTPP_205A-ZBIANHAO, "编号
       ZCD         TYPE ZTPP_205A-ZCD, "长度(米)(门窗除外)
       ZKS         TYPE ZTPP_205A-ZKS, "块数
       ZDETAILNAME TYPE ZTPP_205A-ZDETAILNAME, "详细名称
       ZPCSL       TYPE ZTPP_205A-ZPCSL, "数量
       ZMXBZ       TYPE ZTPP_205A-ZMXBZ, "备注
       ZDTMC       TYPE ZTPP_205A-ZDTMC, "单体名称
       ZLMZX       TYPE ZTPP_205A-ZLMZX, "立面/轴线
       ZYF         TYPE ZTPP_205B-ZYF, "运费
     END OF IT_LCD.
DATA: BEGIN OF WA_EXCEL,
        L_CASE_ZWJ  TYPE CHAR1,
        L_CASE_JHB  TYPE CHAR1,
        L_CASE_LCD  TYPE CHAR1,
        P_FILE_PATH TYPE LOCALFILE,
      END OF WA_EXCEL.

DATA:ZCOLOR TYPE ZTPP_205A-ZCOLOR,
     ZLMZX  TYPE ZTPP_205A-ZLMZX,
     O_FLAG TYPE CHAR1.
DATA:BEGIN OF IT_TAB1 OCCURS 0,"手工净价板-C
       ZBIANHAO TYPE ZTPP_205A-ZBIANHAO, "编号
       ZJJLX    TYPE ZTPP_205A-ZJJLX, "类型
       ZBCKD    TYPE ZTPP_205A-ZBCKD, "宽度(毫米)
       ZCD      TYPE ZTPP_205A-ZCD, "长度(毫米)
       ZKS      TYPE ZTPP_205A-ZKS, "块数
       ZXISHU   TYPE ZTPP_205A-ZXISHU, "系数
       ZMXBZ    TYPE ZTPP_205A-ZMXBZ, "备注
     END OF IT_TAB1,
     BEGIN OF IT_TAB2 OCCURS 0,"机制净化板-D
       ZBIANHAO TYPE ZTPP_205A-ZBIANHAO, "编号
       ZCD      TYPE ZTPP_205A-ZCD, "长度(米)
       ZKS      TYPE ZTPP_205A-ZKS, "块数
       ZXXSHM   TYPE ZTPP_205A-ZXXSHM, "详细说明
       ZMXBZ    TYPE ZTPP_205A-ZMXBZ, "备注
     END OF IT_TAB2,
     BEGIN OF IT_TAB3 OCCURS 0,"门-A
       ZBIANHAO TYPE ZTPP_205A-ZBIANHAO, "编号
       ZCD      TYPE ZTPP_205A-ZCD, "长度(毫米)
       ZBCKD    TYPE ZTPP_205A-ZBCKD, "宽度(毫米)
       ZKS      TYPE ZTPP_205A-ZKS, "块数
       ZMLX     TYPE ZTPP_205A-ZMLX, "类型
       ZKQFX    TYPE ZTPP_205A-ZKQFX, "开启方向
       ZDTMC    TYPE ZTPP_205A-ZDTMC, "单体名称
       ZLMZX    TYPE ZTPP_205A-ZLMZX, "立面轴线
       ZXXSHM   TYPE ZTPP_205A-ZXXSHM, "详细说明
       ZMXBZ    TYPE ZTPP_205A-ZMXBZ, "备注
     END OF IT_TAB3,
     BEGIN OF IT_TAB4 OCCURS 0,"窗-B
       ZBIANHAO TYPE ZTPP_205A-ZBIANHAO, "编号
       ZCD      TYPE ZTPP_205A-ZCD, "长度(毫米)
       ZBCKD    TYPE ZTPP_205A-ZBCKD, "宽度(毫米)
       ZKS      TYPE ZTPP_205A-ZKS, "块数
       ZMLX     TYPE ZTPP_205A-ZMLX, "类型
       ZDTMC    TYPE ZTPP_205A-ZDTMC, "单体名称
       ZLMZX    TYPE ZTPP_205A-ZLMZX, "立面轴线
       ZXXSHM   TYPE ZTPP_205A-ZXXSHM, "详细说明
       ZMXBZ    TYPE ZTPP_205A-ZMXBZ, "备注
     END OF IT_TAB4,
     BEGIN OF IT_TAB5 OCCURS 0,"E-通用
       ZBIANHAO    TYPE ZTPP_205A-ZBIANHAO, "编号
       ZCD         TYPE ZTPP_205A-ZCD, "长度(米)(门窗除外)
       ZYYKS       TYPE ZTPP_205A-ZYYKS, "块数
       ZDETAILNAME TYPE ZTPP_205A-ZDETAILNAME, "详细名称
       ZJSSL       TYPE ZTPP_205A-ZJSSL, "数量
       ZDTMC       TYPE ZTPP_205A-ZDTMC, "单体名称
       ZLMZX       TYPE ZTPP_205A-ZLMZX, "立面/轴线
       ZDREMARK    TYPE ZTPP_205A-ZDREMARK, "备注
     END OF IT_TAB5,
     BEGIN OF IT_TAB6 OCCURS 0,"F-折弯件
       ZBIANHAO    TYPE ZTPP_205A-ZBIANHAO, "编号
       ZCD         TYPE ZTPP_205A-ZCD, "长度(米)
       ZZHANKUAN   TYPE ZTPP_205A-ZZHANKUAN, "展宽
       ZYYKS       TYPE ZTPP_205A-ZYYKS, "块数
       ZZS         TYPE ZTPP_205A-ZZS, "块数
       ZZWHD1      TYPE ZTPP_205A-ZZWHD1, "折弯厚度(厚度)
       ZDANJ       TYPE ZTPP_205A-ZDANJ, "单价
       ZCDTX       TYPE ZTPP_205B-ZCDTX, "成兑贴息
       ZYF         TYPE ZTPP_205B-ZYF, "运费
       ZDTMC       TYPE ZTPP_205A-ZDTMC, "单体名称
       ZLMZX       TYPE ZTPP_205A-ZLMZX, "立面/轴线
       ZDETAILNAME TYPE ZTPP_205A-ZDETAILNAME, "详细名称
       ZDREMARK    TYPE ZTPP_205A-ZDREMARK, "备注
     END OF IT_TAB6,
     BEGIN OF IT_TAB7 OCCURS 0,"G-丽彩鼎
       ZBIANHAO    TYPE ZTPP_205A-ZBIANHAO, "编号
       ZCD         TYPE ZTPP_205A-ZCD, "长度(米)(门窗除外)
       ZBCKD       TYPE ZTPP_205A-ZBCKD, "宽度
       ZYYKS       TYPE ZTPP_205A-ZYYKS, "块数
       ZXISHU      TYPE ZTPP_205A-ZXISHU, "系数
       ZJJLX       TYPE ZTPP_205A-ZJJLX, "类型
       ZCDTX       TYPE ZTPP_205B-ZCDTX, "成兑贴息
       ZYF         TYPE ZTPP_205B-ZYF, "运费
       ZDTMC       TYPE ZTPP_205A-ZDTMC, "单体名称
       ZLMZX       TYPE ZTPP_205A-ZLMZX, "立面/轴线
       ZDETAILNAME TYPE ZTPP_205A-ZDETAILNAME, "详细名称
       ZDREMARK    TYPE ZTPP_205A-ZDREMARK, "备注
     END OF IT_TAB7.
DATA:BEGIN OF IT_QGD OCCURS 0,
       BANFN        TYPE EBAN-BANFN,
       BNFPO        TYPE EBAN-BNFPO,
       MATNR        TYPE EBAN-MATNR,
       POST1        TYPE PRPS-POST1,
       ZZL1         TYPE MARA-ZZL1,
       ZYSJG        TYPE EBAN-ZYSJG,
       ZYCJG        TYPE EBAN-ZYCJG,
       MENGE        TYPE EBAN-MENGE,
       MEINS        TYPE EBAN-MEINS,
       ZSJCML       TYPE EBAN-ZSJCML,
       JGSX         TYPE EBAN-ZYCJG,
       ZWLCMS(2048) TYPE C,
       SQCMS(2048)  TYPE C,
     END OF IT_QGD.
DATA:BEGIN OF IT_CKFY OCCURS 0.
       INCLUDE STRUCTURE ZTPP_205D.
DATA:  CHBOX  TYPE CHAR1,
       DELFLG TYPE CHAR1,
       ZCKFST TYPE DDTEXT,
     END OF IT_CKFY,
     BEGIN OF IT_PCKS_SUM OCCURS 0,
       ZJSXDID  TYPE ZTPP_205A-ZJSXDID,
       ZJSXDDID TYPE ZTPP_205A-ZJSXDDID,
       ZKS      TYPE ZTPP_205A-ZKS,
       KYYKS    TYPE ZTPP_205A-ZKS,
     END OF IT_PCKS_SUM,
     BEGIN OF IT_JSXDS OCCURS 0,
       ZJSXDID  TYPE ZTPP_211-ZJSXDID,
       ZJSXDDID TYPE ZTPP_211-ZJSXDDID,
     END OF IT_JSXDS,
     IT_PCKS_SUM1 LIKE TABLE OF IT_PCKS_SUM WITH HEADER LINE,
     IT_ZTPP_205D TYPE TABLE OF ZTPP_205D WITH HEADER LINE,
     IT_KNUMV     TYPE TABLE OF FARRIC_S_ORDER_KEY WITH HEADER LINE,
     IT_KONV      TYPE TABLE OF V_KONV_CDS WITH HEADER LINE,
     OUTTAB001    TYPE TABLE OF ZSFMS_GETPCTX WITH HEADER LINE,
     IT_AUSP      TYPE TABLE OF AUSP WITH HEADER LINE,
     IT_PCDSUM    LIKE TABLE OF IT_PCD WITH HEADER LINE,
     IT_PCKS      TYPE TABLE OF ZTPP_205A WITH HEADER LINE,
     RETURN_JSXD  TYPE TABLE OF BAPIRET2 WITH HEADER LINE,
     IT_TVM2T     TYPE TABLE OF TVM2T WITH HEADER LINE,
     IT_ZCKFS     TYPE TABLE OF DD07V WITH HEADER LINE,
     IT_ZPCDH     TYPE TABLE OF ZSPP205 WITH HEADER LINE,
     IT_YSKS      TYPE TABLE OF ZSPP205 WITH HEADER LINE,
     FIELDS       TYPE TABLE OF SVAL WITH HEADER LINE.
DATA: IT_FILTER TYPE LVC_T_FIDX.
DATA:RETURNCODE TYPE CHAR1,
     ZHD        TYPE MENGE_D,
     ZYCZK      TYPE MENGE_D,
     JSSL       TYPE MENGE_D,
     ZPCDHHMAX2 TYPE ZTPP_205A-ZPCDHH,
     ZDGS       TYPE I,
     GCBS       TYPE ZE_ZGCBS, "A-钢品，B-洁净,
     MCLX       TYPE ZE_ZMCLX. "A-洁净门，B-洁净窗,C-手工净化板,D-机制净化板
FIELD-SYMBOLS:<FS>      TYPE ANY,
              <IT_MODI> TYPE LVC_T_MODI,
              <WA>      TYPE ANY,
              <FS_TAB>  TYPE STANDARD TABLE.
*冲孔
DATA:CONTAIN_CK     TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
     ALVGRID_CK     TYPE REF TO CL_GUI_ALV_GRID,
     IS_STABLE      TYPE LVC_S_STBL,
     IT_FIELDCAT_CK TYPE LVC_T_FCAT,
     IS_STABLE_CK   TYPE LVC_S_STBL,
     IT_F4_CK       TYPE  LVC_T_F4,
     WA_F4_CK       TYPE  LVC_S_F4,
     WA_LAYOUT_CK   TYPE LVC_S_LAYO,
     WA_MODI_CK     TYPE LVC_S_MODI,
     IT_EF1_CK      TYPE UI_FUNCTIONS,
     VARIANT_CK     TYPE DISVARIANT,
     WA_CELLCOLOR   TYPE LVC_S_SCOL.
CONSTANTS:TCODE1  TYPE SY-TCODE VALUE 'ZPP205C', "
          TCODE2  TYPE SY-TCODE VALUE 'ZPP205D',
          TCODE3  TYPE SY-TCODE VALUE 'ZPP205E',
          TCODE4  TYPE SY-TCODE VALUE 'ZPP205',
          TCODE4A TYPE SY-TCODE VALUE 'ZPP777',
          TCODE5  TYPE SY-TCODE VALUE 'ZPP207',
          DEBL    TYPE DMBTR VALUE '0.3'.
CONSTANTS: GREEN TYPE ICON-ID VALUE '@08@',
           RED   TYPE ICON-ID VALUE '@0A@'.
