*&---------------------------------------------------------------------*
*& Include ZRSD202_TOP
*&---------------------------------------------------------------------*
TYPES:BEGIN OF TY_OUT1 ,
        ZD001 TYPE BAPI_MSG,
        ZD002 TYPE BAPI_MSG,
        ZD003 TYPE BAPI_MSG,
        ZD004 TYPE BAPI_MSG,
        ZD005 TYPE BAPI_MSG,
        ZD006 TYPE BAPI_MSG,
        ZD007 TYPE BAPI_MSG,
        ZD008 TYPE BAPI_MSG,
        ZD009 TYPE BAPI_MSG,
        ZD010 TYPE BAPI_MSG,
        ZD011 TYPE BAPI_MSG,
        ZD012 TYPE BAPI_MSG,
        ZD013 TYPE BAPI_MSG,
        ZD014 TYPE BAPI_MSG,
        ZD015 TYPE BAPI_MSG,
        ZD016 TYPE BAPI_MSG,
        ZD017 TYPE BAPI_MSG,
        ZD018 TYPE BAPI_MSG,
        ZD019 TYPE BAPI_MSG,
        ZD020 TYPE BAPI_MSG,
        ZD021 TYPE BAPI_MSG,
        ZD022 TYPE BAPI_MSG,
        ZD023 TYPE BAPI_MSG,
        ZD024 TYPE BAPI_MSG,
        ZD025 TYPE BAPI_MSG,
        ZD026 TYPE BAPI_MSG,
        ZD027 TYPE BAPI_MSG,
        ZD028 TYPE BAPI_MSG,
        ZD029 TYPE BAPI_MSG,
        ZD030 TYPE BAPI_MSG,
        ZD031 TYPE BAPI_MSG,
        ZD032 TYPE BAPI_MSG,
        ZD033 TYPE BAPI_MSG,
        ZD034 TYPE BAPI_MSG,
        ZD035 TYPE BAPI_MSG,
        ZD036 TYPE BAPI_MSG,
        ZD037 TYPE BAPI_MSG,
        ZD038 TYPE BAPI_MSG,
        ZD039 TYPE BAPI_MSG,
        ZD040 TYPE BAPI_MSG,
        ZD041 TYPE BAPI_MSG,
      END OF TY_OUT1,
      BEGIN OF TY_OUT2,
        TVAKT  TYPE  TVAKT-BEZEI,
        TVM2T  TYPE  TVM2T-BEZEI,
        NAMEW  TYPE NAME1,
        NAMAG  TYPE KNA1-NAME1,
        LGOBE  TYPE LGOBE,
        TVKOT  TYPE TVKOT-VTEXT,
        TVTWT  TYPE TVTWT-VTEXT,
        TVGRT  TYPE TVGRT-BEZEI,
        TVKBT  TYPE TVKBT-BEZEI,
        NAMEL  TYPE NAME1,
        ZYWYT  TYPE NAME1,
        ZYSGST TYPE NAME1,
        TVAGT  TYPE TVAGT-BEZEI,
      END OF TY_OUT2.
DATA:BEGIN OF WA_HEAD.
       INCLUDE STRUCTURE VBAK.
       INCLUDE TYPE TY_OUT2.
DATA:  TDID    TYPE STXL-TDID,
       TDID104 TYPE STXL-TDID,
       TDID105 TYPE STXL-TDID,
       TDID107 TYPE STXL-TDID,
       TDIDT   TYPE CHAR20,
       PSPNR   TYPE VBAK-PS_PSP_PNR,
       POST1   TYPE PRPS-POST1,
       ZWF1    TYPE KBETR,
       LIFNR   TYPE LIFNR,
     END OF WA_HEAD,
     BEGIN OF WA_HCF OCCURS 0,
       VBELN  TYPE VBELN,
       ZYFLX  TYPE ZTMM226-ZYFLX,
       ZYSGS  TYPE VBAK-ZYSGS,
       ZYSGST TYPE NAME1,
       ZYSJE  TYPE ZTMM226-ZYSJE,
       ZSE    TYPE ZTMM226-ZSE,
       ZBHSJE TYPE ZTMM226-ZBHSJE,
       ZBZ    TYPE ZTMM226-ZBZ,
       ZBZ1   TYPE CHAR100,
       ZBZ2   TYPE CHAR100,
       ZSL    TYPE ZTMM226-ZSL,
     END OF WA_HCF,
     BEGIN OF IT_ITEM OCCURS 0.
       INCLUDE STRUCTURE VBAP.
DATA: CHBOX   TYPE CHAR1,
       MAKTX   TYPE MAKTX,
       PSPNR   TYPE VBAP-PS_PSP_PNR,
       POSID   TYPE PRPS-POSID,
       POST1   TYPE PRPS-POST1,
       ZCKZTT  TYPE CHAR20,
       GUIGE   TYPE STRING,
       ZZL1    TYPE MARA-ZZL1,
       NAMEW   TYPE NAME1,
       LGOBE   TYPE LGOBE,
       TVM2T   TYPE TVM2T-BEZEI,
       ZZHWZT1 TYPE DDTEXT,
       ZZHWZT  TYPE DDTEXT,
       ZPR0    TYPE KBETR,
       ZPRR    TYPE KBETR,
       CKL     TYPE LFIMG,
     END OF IT_ITEM,
     BEGIN OF IT_TEXT OCCURS 0,
       TDID TYPE STXL-TDID.
       INCLUDE STRUCTURE ZSMM202.
DATA:END OF IT_TEXT,
BEGIN OF IT_ZQSDT OCCURS 0,
  ZQSDT TYPE VBAK-ZQSD,
END OF IT_ZQSDT,
TEXTTABLE TYPE TABLE OF ZSMM202 WITH HEADER LINE.
DATA:OK_CODE     TYPE SY-UCOMM,
     OK_CODE1    TYPE SY-UCOMM,
     OK_CODE2    TYPE SY-UCOMM,
     OK_CODE9004 TYPE SY-UCOMM,
     SAVE_CODE   TYPE SY-UCOMM,
     ANSWER      TYPE CHAR1.
DATA:BEGIN OF IT_ACTYS OCCURS 0,
       ACT TYPE ZE_ACT,
       BUT TYPE SY-UCOMM,
     END OF IT_ACTYS,
     BEGIN OF IT_LIST1 OCCURS 0,
       TDID TYPE TDID,
       TEXT TYPE CHAR20,
     END OF IT_LIST1,
     IT_OUT1   TYPE TABLE OF TY_OUT1 WITH HEADER LINE,
     IT_LISTN  LIKE TABLE OF IT_LIST1 WITH HEADER LINE,
     IT_LISTN1 LIKE TABLE OF IT_LIST1 WITH HEADER LINE,
     IT_LIST1A LIKE TABLE OF IT_LIST1 WITH HEADER LINE,
     FIELDS    TYPE TABLE OF SVAL WITH HEADER LINE.
DATA:GO_EDITOR              TYPE REF TO CL_GUI_TEXTEDIT,
     GO_EDITOR_CONTAINER    TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
     GO_EDITOR104           TYPE REF TO CL_GUI_TEXTEDIT,
     GO_EDITOR_CONTAINER104 TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
     GO_EDITOR105           TYPE REF TO CL_GUI_TEXTEDIT,
     GO_EDITOR_CONTAINER105 TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
     GO_EDITOR107           TYPE REF TO CL_GUI_TEXTEDIT,
     GO_EDITOR_CONTAINER107 TYPE REF TO CL_GUI_CUSTOM_CONTAINER.
DATA:CONTAIN      TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
     ALVGRID      TYPE REF TO CL_GUI_ALV_GRID,
     IT_FIELDCAT  TYPE LVC_T_FCAT,
     WA_FIELDCAT  TYPE LVC_S_FCAT,
     IS_STABLE    TYPE LVC_S_STBL,
     WA_LAYOUT    TYPE LVC_S_LAYO,
     IT_EF1       TYPE UI_FUNCTIONS,
     VARIANT      TYPE DISVARIANT,
     CONTAIN1     TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
     ALVGRID1     TYPE REF TO CL_GUI_ALV_GRID,
     IT_FIELDCAT1 TYPE LVC_T_FCAT,
     IS_STABLE1   TYPE LVC_S_STBL,
     WA_LAYOUT1   TYPE LVC_S_LAYO,
     IT_EF2       TYPE UI_FUNCTIONS,
     VARIANT1     TYPE DISVARIANT,
     CONTAIN2     TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
     ALVGRID2     TYPE REF TO CL_GUI_ALV_GRID,
     IT_FIELDCAT2 TYPE LVC_T_FCAT,
     IS_STABLE2   TYPE LVC_S_STBL,
     WA_LAYOUT2   TYPE LVC_S_LAYO,
     IT_EF3       TYPE UI_FUNCTIONS,
     VARIANT2     TYPE DISVARIANT,
     IT_DROP      TYPE LVC_T_DROP,
     WA_DROP      TYPE LVC_S_DROP.
FIELD-SYMBOLS:<IT_MODI> TYPE LVC_T_MODI,
              <FS>      TYPE ANY,
              <FS1>     TYPE ANY,
              <ITAB>    TYPE STANDARD TABLE,
              <ITABN>   TYPE STANDARD TABLE.
DATA:TA1       TYPE CHAR30,
     TA2       TYPE CHAR40,
     TA3       TYPE CHAR40,
     LX        TYPE CHAR10,
     TDNAME    TYPE STXL-TDNAME,
     NUM       TYPE I,
     ACT       TYPE ZE_ACT,
     RTYPE     TYPE BAPI_MTYPE,
     RTMSG     TYPE BAPI_MSG,
     P1_X      TYPE CHAR1,
     P2_X      TYPE CHAR1,
     P3_X      TYPE CHAR1,
     ZDH       TYPE ZE_ZYFXH,
     TABIX     TYPE SY-TABIX,
     TDID      TYPE TDID,
     VBELN     TYPE VBELN,
     FLAG      TYPE ZEMM_FLAG,
     CXROOT    TYPE REF TO CX_ROOT,
     MESSAGE   TYPE ZEMM_MESSAGE,
     WA_DXVBAK TYPE VBAK,
     SCREENNO  TYPE SY-DYNNR.
DATA:RETURN    TYPE TABLE OF BAPIRET2 WITH HEADER LINE,
     RETURNLOG TYPE TABLE OF BAPIRET2 WITH HEADER LINE,
     IT_POSNR  TYPE TABLE OF POSNR_LINE WITH HEADER LINE.
RANGES:S_PSPNR FOR PRPS-PSPNR,
       S_KSCHL FOR KONV-KSCHL,
       S_ABGRU FOR VBAP-ABGRU.
CONSTANTS:TCODE1 TYPE SY-TCODE VALUE 'ZSD202',
          TCODE2 TYPE SY-TCODE VALUE 'ZSD203',
          TCODE3 TYPE SY-TCODE VALUE 'ZSD204',
          TCODE4 TYPE SY-TCODE VALUE 'ZSD204A',
          TCODE5 TYPE SY-TCODE VALUE 'ZSD205',
          TCODE6 TYPE SY-TCODE VALUE 'ZSD206',
          TCODE7 TYPE SY-TCODE VALUE 'ZSD207',
          GREEN  TYPE ICON-ID VALUE '@08@',
          RED    TYPE ICON-ID VALUE '@0A@'.

DATA:FIELDCAT TYPE SLIS_T_FIELDCAT_ALV,
     WA_FIELD TYPE SLIS_FIELDCAT_ALV.
DATA:BEGIN OF ITAB1 OCCURS 0.
DATA:  VBELN    TYPE  VBAK-VBELN,
       VKORG    TYPE  VBAK-VKORG,
       VTWEG    TYPE  VBAK-VTWEG,
       VKGRP    TYPE  VBAK-VKGRP,
       VKBUR    TYPE  VBAK-VKBUR,
       AUART    TYPE  VBAK-AUART,
       KUNNR    TYPE  VBAK-KUNNR,
       AUGRU    TYPE  VBAK-AUGRU,
       ZYWY     TYPE  VBAK-ZYWY,
       GUEBG    TYPE  VBAK-GUEBG,
       ZHTBB    TYPE  VBAK-ZHTBB,
       ZHTLY    TYPE  VBAK-ZHTLY,
       ZZT1     TYPE  VBAK-ZZT1,
       ZTTZT    TYPE  VBAK-ZTTZT,
       KNUMV    TYPE  VBAK-KNUMV,
       ZJHFS    TYPE  VBAK-ZJHFS,
       AUDAT    TYPE  VBAK-AUDAT,
       ZDJRQ    TYPE  VBAK-ZDJRQ,
       GUEEN    TYPE  VBAK-GUEEN,
       ZGPDJBL  TYPE  VBAK-ZGPDJBL,
       ZQSD     TYPE VBAK-ZQSD,
       ZJRTH    TYPE   VBAK-ZJRTH,
       ZJRTHWB  TYPE VBAK-ZJRTHWB,
       ZDJSCDZ  TYPE VBAK-ZDJSCDZ,
       MVGR2    TYPE  VBAP-MVGR2,
       GROES    TYPE  VBAP-GROES,
       POSNR    TYPE  VBAP-POSNR,
       UEPOS    TYPE  VBAP-UEPOS,
       MATNR    TYPE  VBAP-MATNR,
       KWMENG   TYPE  VBAP-KWMENG,
       VRKME    TYPE  VBAP-VRKME,
       WERKS    TYPE  VBAP-WERKS,
       LGORT    TYPE  VBAP-LGORT,
       MVGR3    TYPE  VBAP-MVGR3,
       KZWI5    TYPE  VBAP-KZWI5,
       KZWI6    TYPE  VBAP-KZWI6,
       PSTYV    TYPE  VBAP-PSTYV,
       PSPNR    TYPE  VBAP-PS_PSP_PNR,
       VSTEL    TYPE  VBAP-VSTEL,
       ABGRU    TYPE  VBAP-ABGRU,
       BSTKD    TYPE  VBKD-BSTKD,
       MAKTX    TYPE MAKT-MAKTX,
       POST1    TYPE  PRPS-POST1,
       POSID    TYPE  PRPS-POSID,
       ZZL1     TYPE MARA-ZZL1,
       GUIGE    TYPE  CHAR220,
       NAME1    TYPE  KNA1-NAME1,
       ZHTLYT   TYPE  KNA1-NAME1,
       ZZT1T    TYPE  DDTEXT,
       ZPR0     TYPE  ZE_JEXSW,
       ZPRR     TYPE  ZE_JEXSW,
       KFHSL    TYPE MENGE_D,
       CHBOX1   TYPE CHAR1,
       VBBPZ001 TYPE STRING,
       DJSJDZ   TYPE SY-DATUM,
       SJDJBL   TYPE MENGE_D,
       DJWY     TYPE CHAR10,
       HTZXWY   TYPE CHAR10,
       DJWYTS   TYPE INT1,
       HTZXWYTS TYPE INT1,
*       ZHY    TYPE  VBAK-ZHY,
*       SYYKPJE TYPE ZEFI_DMBTR_RYLF ,
*       YKPCHJE TYPE ZEFI_DMBTR_RYBK ,
*       QZCLJE TYPE ZEFI_DMBTR_RYBKS,
       SEL ,
       HANDLE,
       ALVTITLE,
       TOPPAGE.
       INCLUDE TYPE TY_OUT2.
       INCLUDE STRUCTURE ZSSD262.
DATA:END OF ITAB1,
BEGIN OF ITAB OCCURS 0.
DATA: VKORG   TYPE VBAK-VKORG,
      VTWEG   TYPE VBAK-VTWEG,
      VKGRP   TYPE VBAK-VKGRP,
      VKBUR   TYPE VBAK-VKBUR,
      KUNNR   TYPE VBAK-KUNNR,
      KNUMV   TYPE  VBAK-KNUMV,
      ERNAM   TYPE VBAK-ERNAM,
      ERDAT   TYPE VBAK-ERDAT,
      GUEBG   TYPE  VBAK-GUEBG,
      ZT      TYPE  VBAK-ZTTZT,
      VBELN   TYPE VBAP-VBELN,
      POSNR   TYPE VBAP-POSNR,
      VGBEL   TYPE VBAP-VGBEL,
      VGPOS   TYPE VBAP-VGPOS,
      PSPNR   TYPE VBAP-PS_PSP_PNR,
      MVGR2   TYPE  VBAP-MVGR2,
      MATNR   TYPE  VBAP-MATNR,
      KWMENG  TYPE  VBAP-KWMENG,
      VRKME   TYPE  VBAP-VRKME,
      WERKS   TYPE  VBAP-WERKS,
      LGORT   TYPE  VBAP-LGORT,
      MVGR3   TYPE  VBAP-MVGR3,
      KZWI5   TYPE  VBAP-KZWI5,
      KZWI6   TYPE  VBAP-KZWI6,
      PSTYV   TYPE  VBAP-PSTYV,
      ZGROES  TYPE  VBAP-GROES,
      BSTKD   TYPE VBKD-BSTKD,
      MAKTX   TYPE MAKT-MAKTX,
      POSID   TYPE PRPS-POSID,
      POST1   TYPE PRPS-POST1,
      ZHTLY1  TYPE VBAK-ZHTLY,
      ZZL1  TYPE MARA-ZZL1.
      INCLUDE STRUCTURE ZSSD_ENH_VBAK.
      INCLUDE STRUCTURE ZSSD_ENH_VBAP.
      INCLUDE TYPE TY_OUT1.
      INCLUDE TYPE TY_OUT2.
DATA: Z104    TYPE STRING,
      Z105    TYPE STRING,
      Z106    TYPE STRING,
      Z107    TYPE STRING,
      Z108    TYPE STRING,
      Z109    TYPE STRING,
      Z110    TYPE STRING,
      Z111    TYPE STRING,
      ZPR0    TYPE KBETR,
      ZPRR    TYPE KBETR,
      ZWF1    TYPE KBETR,
      CKL     TYPE LFIMG,
      LIFNR   TYPE LIFNR,
      NAMTV   TYPE NAME1,
      ZTTZTT  TYPE CHAR20,
      ZJHFST  TYPE CHAR20,
      GUIGE   TYPE STRING,
      ZYSJE1 TYPE KBETR,
      TOPPAGE,
      SEL,
      HANDLE,
      ICON    TYPE ICON-ID,
      MSG     TYPE BAPI_MSG,
      VBELV   TYPE VBELN,
      END OF ITAB,
      BEGIN OF IT_VBAKENH OCCURS 0.
        INCLUDE STRUCTURE ZSSD_ENH_VBAK.
DATA: VBELN TYPE VBELN,
      END OF IT_VBAKENH,
      BEGIN OF IT_VBAPENH OCCURS 0.
        INCLUDE STRUCTURE ZSSD_ENH_VBAP.
DATA: VBELN TYPE VBELN,
        POSNR TYPE POSNR,
      END OF IT_VBAPENH,
      BEGIN OF IT_SOTEXT OCCURS 0,
        VBELN TYPE VBELN,
        TDID  TYPE TDID,
        TEXT  TYPE STRING,
      END OF IT_SOTEXT,
      BEGIN OF IT_YS1 OCCURS 0,
        KSCHL TYPE KSCHL,
        TYPE  TYPE CHAR1,
        FIELD TYPE FIELDNAME,
      END OF IT_YS1,
      IT_ZZHWZ   TYPE TABLE OF DD07V WITH HEADER LINE,
      IT_ZCKZT   TYPE TABLE OF DD07V WITH HEADER LINE,
      IT_ZZT1    TYPE TABLE OF DD07V WITH HEADER LINE,
      IT_ZTTZT   TYPE TABLE OF DD07V WITH HEADER LINE,
      IT_ZJHFS   TYPE TABLE OF DD07V WITH HEADER LINE,
      IT_TVKOT   TYPE TABLE OF TVKOT WITH HEADER LINE,
      IT_TVTWT   TYPE TABLE OF TVTWT WITH HEADER LINE,
      IT_TVGRT   TYPE TABLE OF TVGRT WITH HEADER LINE,
      IT_T001W   TYPE TABLE OF T001W WITH HEADER LINE,
      IT_T001L   TYPE TABLE OF T001L WITH HEADER LINE,
      IT_LFA1    TYPE TABLE OF LFA1 WITH HEADER LINE,
      IT_TVAKT   TYPE TABLE OF TVAKT WITH HEADER LINE,
      IT_TVM2T   TYPE TABLE OF TVM2T WITH HEADER LINE,
      IT_TVKBT   TYPE TABLE OF TVKBT WITH HEADER LINE,
      IT_KNA1    TYPE TABLE OF KNA1 WITH HEADER LINE,
      ITAB2      LIKE TABLE OF ITAB1 WITH HEADER LINE,
      ITAB3      LIKE TABLE OF ITAB1 WITH HEADER LINE,
      IT_VBELN   TYPE TABLE OF LIPS_KEY WITH HEADER LINE,
      IT_TVAGT   TYPE TABLE OF TVAGT WITH HEADER LINE,
      IT_VBELN1  TYPE TABLE OF LIPS_KEY WITH HEADER LINE,
      IT_PSPNR   TYPE TABLE OF CKF_WBS WITH HEADER LINE,
      IT_KNUMV   TYPE TABLE OF WLF_S_KNUMV WITH HEADER LINE,
      IT_KONV    TYPE TABLE OF V_KONV_CDS WITH HEADER LINE,
      IT_VBPA    TYPE TABLE OF VBPA WITH HEADER LINE,
      IT_ZSSD263 TYPE TABLE OF ZSSD263 WITH HEADER LINE,
      IT_KUNNR   TYPE TABLE OF WKUNNR WITH HEADER LINE,
      IT_LIFNR   TYPE TABLE OF LFA1_KEY WITH HEADER LINE,
      IT_FHTZ    TYPE TABLE OF ZSSDCKD WITH HEADER LINE.
DATA:SELSTR TYPE STRING.
RANGES:S_ZT FOR VBAK-ZTTZT.
DEFINE MSG.
  IF &1+0(1) = 'S'.
    MESSAGE &1 TYPE 'S'.
  ELSE.
    MESSAGE S000(OO) WITH &1 DISPLAY LIKE 'E'.
  ENDIF.
END-OF-DEFINITION.
