*&---------------------------------------------------------------------*
*& Include ZRFI202_TOP
*&---------------------------------------------------------------------*
TYPE-POOLS:SLIS,ICON.
DATA:FIELDCAT   TYPE SLIS_T_FIELDCAT_ALV,
     FIELDCAT1  TYPE SLIS_T_FIELDCAT_ALV,
     FIELDCATEX TYPE SLIS_T_FIELDCAT_ALV,
     WA_FIELD   TYPE SLIS_FIELDCAT_ALV.
TYPES:BEGIN OF TY_OUT1,
        BUTXT     TYPE T001-BUTXT,
        NAMEW     TYPE T001W-NAME1,
        LGOBE     TYPE T001L-LGOBE,
        POST1     TYPE PRPS-POST1,
        SEGMT     TYPE FAGL_SEGMT-NAME,
        MAKTX     TYPE MAKTX,
        FLHT      TYPE MAKTX,
        MATNR_RDT TYPE MAKTX,
        RDSTATET  TYPE DDTEXT,
        PRSTATET  TYPE DDTEXT,
        INAUFNRT  TYPE AUFK-KTEXT,
      END OF TY_OUT1,
      BEGIN OF TY_OUT2,
        CHBOX   TYPE CHAR1,
        TOPPAGE,
        ICON    TYPE ICON-ID,
        MSG     TYPE BAPI_MSG,
        HANDLE  TYPE CHAR4,
      END OF TY_OUT2.
DATA:BEGIN OF ITAB OCCURS 0.
       INCLUDE STRUCTURE ZTFIRD_MATDATA.
       INCLUDE TYPE TY_OUT1.
       INCLUDE TYPE TY_OUT2.
DATA:  FLAG TYPE CHAR1,
       KALNR TYPE CKMLHD-KALNR,
     END OF ITAB,
     BEGIN OF IT_WERKS OCCURS 0,
       BUKRS TYPE T001-BUKRS,
       BUTXT TYPE T001-BUTXT,
       WERKS TYPE WERKS_D,
       NAME1 TYPE NAME1,
     END OF IT_WERKS,
     BEGIN OF IT_OUTOBJNR OCCURS 0.
       INCLUDE STRUCTURE BAPIOBJNR.
DATA: STA  TYPE BAPI_MSG,
       TEXT TYPE BAPI_MSG,
     END OF IT_OUTOBJNR.
DATA:ITAB1             LIKE TABLE OF ITAB WITH HEADER LINE,
     ITAB2             LIKE TABLE OF ITAB WITH HEADER LINE,
     IT_DETAIL         LIKE TABLE OF ITAB WITH HEADER LINE,
     IT_AUFNR          TYPE TABLE OF CKI_AUFNR WITH HEADER LINE,
     IT_AUFK           TYPE TABLE OF AUFK WITH HEADER LINE,
     IT_OBJNR          TYPE TABLE OF BAPIOBJNR WITH HEADER LINE,
     IT_ZTFIRD_MATDATA TYPE TABLE OF ZTFIRD_MATDATA WITH HEADER LINE,
     IT_T001W          TYPE TABLE OF T001W WITH HEADER LINE,
     IT_T001L          TYPE TABLE OF T001L WITH HEADER LINE,
     IT_T001           TYPE TABLE OF T001 WITH HEADER LINE,
     IT_SEGMT          TYPE TABLE OF FAGL_SEGMT WITH HEADER LINE,
     IT_ZTFI203        TYPE TABLE OF ZTFI203 WITH HEADER LINE,
     IT_ZTFI204        TYPE TABLE OF ZTFI204 WITH HEADER LINE,
     IT_RDSTATE        TYPE TABLE OF DD07V WITH HEADER LINE,
     IT_PRSTATE        TYPE TABLE OF DD07V WITH HEADER LINE,
     IT_MATNR          TYPE TABLE OF CCVX_MATNR WITH HEADER LINE,
     IT_PSPNR          TYPE TABLE OF CKF_WBS WITH HEADER LINE,
     IT_PRPS           TYPE TABLE OF PRPS WITH HEADER LINE,
     IT_MBEWS          TYPE TABLE OF ATPMP WITH HEADER LINE,
     RETURN            TYPE TABLE OF BAPIRET2 WITH HEADER LINE,
     IT_MAKT           TYPE TABLE OF MAKT WITH HEADER LINE,
     WA                LIKE LINE OF ITAB.
DATA:EXCLUDE    TYPE TABLE OF SY-UCOMM,
     TCODE      TYPE SY-TCODE,
     OK_CODE    TYPE SY-UCOMM,
     OK_CODE1   TYPE SY-UCOMM,
     HANDLE     TYPE CHAR4,
     TDID       TYPE TDID,
     RND_MIN    TYPE BBSEG-WRBTR,
     RND_MAX    TYPE BBSEG-WRBTR,
     RND_AMOUNT TYPE BBSEG-WRBTR,
     ZNUMBER    TYPE ZTNUMS_UPDATE-ZNUMBER10,
     TABIX      TYPE SY-TABIX,
     NUM        TYPE I,
     NUM1       TYPE I,
     ANSWER     TYPE CHAR1,
     MBLNR      TYPE MBLNR,
     MJAHR      TYPE MJAHR,
     MSG        TYPE BAPI_MSG,
     RTYPE      TYPE BAPI_MTYPE,
     RTMSG      TYPE BAPI_MSG,
     POPER      TYPE CKMLCR-POPER,
     L_MSG      TYPE BAPI_MSG.
RANGES:R_WERKS FOR T001W-WERKS,
       R_RDSTATE FOR ZTFIRD_MATDATA-RDSTATE.
*OO-ALV
DATA:GO_EDITOR           TYPE REF TO CL_GUI_TEXTEDIT,
     GO_EDITOR_CONTAINER TYPE REF TO CL_GUI_CUSTOM_CONTAINER.
DATA:CONTAIN       TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
     ALVGRID       TYPE REF TO CL_GUI_ALV_GRID,
     IT_FIELDCAT   TYPE LVC_T_FCAT,
     IT_FIELDCATEX TYPE LVC_T_FCAT,
     WA_FIELDCAT   TYPE LVC_S_FCAT,
     IT_F4         TYPE  LVC_T_F4,
     WA_F4         TYPE  LVC_S_F4,
     IS_STABLE     TYPE LVC_S_STBL,
     WA_LAYOUT     TYPE LVC_S_LAYO,
     IT_EF1        TYPE UI_FUNCTIONS,
     VARIANT       TYPE DISVARIANT,
     CONTAIN1      TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
     ALVGRID1      TYPE REF TO CL_GUI_ALV_GRID,
     IT_FIELDCAT1  TYPE LVC_T_FCAT,
     IS_STABLE1    TYPE LVC_S_STBL,
     WA_MODI       TYPE LVC_S_MODI,
     WA_RETURN_TAB TYPE DDSHRETVAL,
     RETURN_TAB    TYPE TABLE OF DDSHRETVAL WITH HEADER LINE,
     FIELD_TAB     TYPE TABLE OF DFIES WITH HEADER LINE.
FIELD-SYMBOLS:<FS>      TYPE ANY,
              <FS1>     TYPE ANY,
              <WA>      TYPE ANY,
              <IT_MODI> TYPE LVC_T_MODI,
              <ITAB>    TYPE STANDARD TABLE.
CONSTANTS:TCODE1 TYPE SY-TCODE VALUE 'ZFI203A',
          TCODE2 TYPE SY-TCODE VALUE 'ZFI203B',
          TCODE3 TYPE SY-TCODE VALUE 'ZFI203C',
          TCODE4 TYPE SY-TCODE VALUE 'ZFI203D',
          TCODE5 TYPE SY-TCODE VALUE 'ZFI203E',
          TCODE6 TYPE SY-TCODE VALUE 'ZFI203F',
          CE     TYPE MENGE_D VALUE '0.3',
          EXEC   TYPE CHAR4 VALUE 'ONLI',
          GREEN  TYPE ICON-ID VALUE '@08@',
          RED    TYPE ICON-ID VALUE '@0A@'.
